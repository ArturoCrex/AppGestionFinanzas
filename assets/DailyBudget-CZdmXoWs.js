import{u as Y,d as W,r as l,j as e}from"./index-BIJJ6zyg.js";import{g as G,b as J}from"./dataService-DkYNsTWt.js";import{f as m}from"./formatCurrency-CNSA3FR6.js";import{s as i}from"./shared.module-DtX0B0CA.js";const K="_green_ortsu_21",P="_yellow_ortsu_29",Q="_red_ortsu_37",s={"budget-hero":"_budget-hero_ortsu_1",green:K,yellow:P,red:Q,"budget-amount":"_budget-amount_ortsu_45","budget-label":"_budget-label_ortsu_59","budget-value":"_budget-value_ortsu_73","budget-progress":"_budget-progress_ortsu_93","budget-progress-fill":"_budget-progress-fill_ortsu_111","budget-spent":"_budget-spent_ortsu_125","budget-grid":"_budget-grid_ortsu_141","budget-card":"_budget-card_ortsu_155","card-icon":"_card-icon_ortsu_189","card-label":"_card-label_ortsu_197","card-value":"_card-value_ortsu_209"};function se(){const{t:a}=Y(),{currency:c,monthlyIncome:_,dailyBudgetLimit:f,savingsTarget:N,setMonthlyIncome:C,setDailyBudgetLimit:R,setSavingsTarget:E}=W(),[p,k]=l.useState([]),[w,A]=l.useState([]),[o,q]=l.useState(_),[u,F]=l.useState(f),[g,$]=l.useState(N),[z,T]=l.useState(!1);l.useEffect(()=>{const n=new Date,x=new Date(n.getFullYear(),n.getMonth(),1);G(x).then(k),J().then(y=>{A(y.filter(h=>h.active))})},[]);const H=o!==_||u!==f||g!==N;function O(){C(o),R(u),E(g),T(!0),setTimeout(()=>T(!1),2e3)}const d=l.useMemo(()=>{const n=new Date,x=new Date(n.getFullYear(),n.getMonth()+1,0).getDate(),y=n.getDate(),h=x-y+1,U=p.filter(t=>t.type==="income").reduce((t,r)=>t+r.amount,0),B=o>0?o:U,S=w.reduce((t,r)=>r.frequency==="monthly"?t+r.amount:r.frequency==="yearly"?t+r.amount/12:r.frequency==="weekly"?t+r.amount*4.33:t,0),M=p.filter(t=>t.type==="expense").reduce((t,r)=>t+r.amount,0),D=new Date;D.setHours(0,0,0,0);const I=p.filter(t=>{const r=new Date(t.date);return r.setHours(0,0,0,0),t.type==="expense"&&r.getTime()===D.getTime()}).reduce((t,r)=>t+r.amount,0),L=B-S-g-M,v=u>0?u:Math.max(0,L/h),b=v>0?I/v*100:0;let j="green";return b>90?j="red":b>60&&(j="yellow"),{effectiveIncome:B,fixedExpenses:S,spentThisMonth:M,spentToday:I,dailyLimit:v,daysRemaining:h,savingsTarget:g,percentUsed:b,status:j,availableForMonth:L}},[p,w,o,u,g]);return e.jsxs("div",{className:i.page,children:[e.jsx("h2",{children:a("dailyBudget.title")}),e.jsxs("div",{className:`${s["budget-hero"]} ${s[d.status]}`,children:[e.jsxs("div",{className:s["budget-amount"],children:[e.jsx("span",{className:s["budget-label"],children:a("dailyBudget.todayLimit")}),e.jsx("span",{className:s["budget-value"],children:m(d.dailyLimit,c)})]}),e.jsx("div",{className:s["budget-progress"],children:e.jsx("div",{className:s["budget-progress-fill"],style:{width:`${Math.min(d.percentUsed,100)}%`}})}),e.jsxs("div",{className:s["budget-spent"],children:[e.jsxs("span",{children:[a("dailyBudget.spentToday"),": ",m(d.spentToday,c)]}),e.jsxs("span",{children:[a("dailyBudget.remaining"),": ",m(Math.max(0,d.dailyLimit-d.spentToday),c)]})]})]}),e.jsxs("div",{className:s["budget-grid"],children:[e.jsxs("div",{className:s["budget-card"],children:[e.jsx("span",{className:s["card-icon"],children:"ðŸ’°"}),e.jsx("span",{className:s["card-label"],children:a("dailyBudget.monthlyIncome")}),e.jsx("span",{className:s["card-value"],children:m(d.effectiveIncome,c)})]}),e.jsxs("div",{className:s["budget-card"],children:[e.jsx("span",{className:s["card-icon"],children:"ðŸ“‹"}),e.jsx("span",{className:s["card-label"],children:a("dailyBudget.fixedExpenses")}),e.jsx("span",{className:s["card-value"],children:m(d.fixedExpenses,c)})]}),e.jsxs("div",{className:s["budget-card"],children:[e.jsx("span",{className:s["card-icon"],children:"ðŸ›’"}),e.jsx("span",{className:s["card-label"],children:a("dailyBudget.spentThisMonth")}),e.jsx("span",{className:s["card-value"],children:m(d.spentThisMonth,c)})]}),e.jsxs("div",{className:s["budget-card"],children:[e.jsx("span",{className:s["card-icon"],children:"ðŸ“…"}),e.jsx("span",{className:s["card-label"],children:a("dailyBudget.daysRemaining")}),e.jsx("span",{className:s["card-value"],children:d.daysRemaining})]})]}),e.jsxs("div",{className:i["settings-section"],children:[e.jsx("h3",{className:i["settings-title"],children:a("dailyBudget.configure")}),e.jsxs("div",{className:i["settings-row"],children:[e.jsx("span",{className:i["settings-label"],children:a("dailyBudget.monthlyIncome")}),e.jsx("input",{type:"number",value:o||"",onChange:n=>q(Number(n.target.value)),placeholder:a("dailyBudget.autoDetect"),style:{width:"140px",textAlign:"right",padding:"var(--space-xs) var(--space-sm)",borderRadius:"var(--radius-md)",border:"1px solid var(--color-border)",background:"var(--color-bg)",color:"var(--color-text)"}})]}),e.jsxs("div",{className:i["settings-row"],children:[e.jsx("span",{className:i["settings-label"],children:a("dailyBudget.savingsTarget")}),e.jsx("input",{type:"number",value:g||"",onChange:n=>$(Number(n.target.value)),placeholder:"0",style:{width:"140px",textAlign:"right",padding:"var(--space-xs) var(--space-sm)",borderRadius:"var(--radius-md)",border:"1px solid var(--color-border)",background:"var(--color-bg)",color:"var(--color-text)"}})]}),e.jsxs("div",{className:i["settings-row"],children:[e.jsx("span",{className:i["settings-label"],children:a("dailyBudget.customLimit")}),e.jsx("input",{type:"number",value:u||"",onChange:n=>F(Number(n.target.value)),placeholder:a("dailyBudget.autoCalc"),style:{width:"140px",textAlign:"right",padding:"var(--space-xs) var(--space-sm)",borderRadius:"var(--radius-md)",border:"1px solid var(--color-border)",background:"var(--color-bg)",color:"var(--color-text)"}})]}),e.jsxs("div",{style:{marginTop:"var(--space-md)",display:"flex",alignItems:"center",gap:"var(--space-sm)"},children:[e.jsxs("button",{className:i["btn-primary"],onClick:O,style:{opacity:H?1:.6,width:"100%",justifyContent:"center"},children:["ðŸ’¾ ",a("common.save")]}),z&&e.jsxs("span",{style:{color:"var(--color-success)",fontSize:"var(--font-size-sm)",fontWeight:600,whiteSpace:"nowrap"},children:["âœ“ ",a("common.saved")]})]})]})]})}export{se as default};
