import{u as R,d as A,r as t,j as a}from"./index-BIJJ6zyg.js";import{a as O,u as I,c as F,d as G}from"./dataService-DkYNsTWt.js";import{f as L}from"./formatCurrency-CNSA3FR6.js";import{a as W}from"./dateHelpers-CV5MkOD6.js";import{g as Y}from"./categoryColors-CUu1E-0A.js";import{s as r}from"./shared.module-DtX0B0CA.js";const f={food:"ðŸ”",transport:"ðŸš—",entertainment:"ðŸŽ®",health:"ðŸ’Š",education:"ðŸ“š",housing:"ðŸ ",utilities:"ðŸ’¡",shopping:"ðŸ›ï¸",salary:"ðŸ’¼",freelance:"ðŸ’»",investment:"ðŸ“ˆ",official:"ðŸ›ï¸",medical:"ðŸ¥",leisure:"ðŸŽ‰",restaurant:"ðŸ½ï¸",subscription:"ðŸ”„",other:"ðŸ“Œ"},_=Object.keys(f);function P(){const{t:s}=R(),b=A(e=>e.currency),[j,k]=t.useState([]),[D,w]=t.useState(!0),[i,d]=t.useState(!1),[n,S]=t.useState(null),[c,l]=t.useState("expense"),[p,m]=t.useState(0),[N,u]=t.useState("food"),[v,g]=t.useState(""),[C,x]=t.useState(new Date().toISOString().slice(0,10));t.useEffect(()=>{y()},[]);async function y(){try{const e=await O();k(e)}catch(e){console.error("Error loading transactions:",e)}finally{w(!1)}}function h(){l("expense"),m(0),u("food"),g(""),x(new Date().toISOString().slice(0,10)),S(null),d(!1)}function T(e){S(e),l(e.type),m(e.amount),u(e.category),g(e.description),x(new Date(e.date).toISOString().slice(0,10)),d(!0)}async function E(){if(!v.trim()||p<=0)return;const e=new Date,o={type:c,amount:p,currency:b,category:N,description:v.trim(),date:new Date(C),attachments:n?.attachments||[],createdAt:n?.createdAt||e,updatedAt:e};try{n?.id?await I(n.id,o):await F(o),h(),await y()}catch($){console.error("Error saving transaction:",$)}}async function z(e){try{await G(e),await y()}catch(o){console.error("Error deleting transaction:",o)}}return D?a.jsx("div",{className:r["empty-state"],children:a.jsx("div",{className:"animate-pulse",children:s("common.loading")})}):a.jsxs("div",{className:r.page,children:[a.jsxs("div",{className:r["page-header"],children:[a.jsx("h2",{children:s("transactions.title")}),a.jsx("button",{className:r["btn-primary"],onClick:()=>{h(),d(!i)},children:i?s("common.cancel"):`ï¼‹ ${s("transactions.add")}`})]}),i&&a.jsxs("div",{style:{background:"var(--color-surface)",border:"1px solid var(--color-border)",borderRadius:"var(--radius-lg)",padding:"var(--space-lg)",display:"flex",flexDirection:"column",gap:"var(--space-md)"},children:[a.jsx("h3",{style:{margin:0},children:s(n?"transactions.edit":"transactions.add")}),a.jsxs("div",{style:{display:"flex",gap:"var(--space-xs)"},children:[a.jsx("button",{className:`${r["toggle-btn"]} ${c==="expense"?r.active:""}`,onClick:()=>l("expense"),style:c==="expense"?{background:"var(--color-danger)",borderColor:"var(--color-danger)"}:{},children:s("transactions.expense")}),a.jsx("button",{className:`${r["toggle-btn"]} ${c==="income"?r.active:""}`,onClick:()=>l("income"),style:c==="income"?{background:"var(--color-success)",borderColor:"var(--color-success)"}:{},children:s("transactions.income")})]}),a.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"4px"},children:[a.jsx("label",{style:{fontSize:"var(--font-size-sm)",color:"var(--color-text-muted)"},children:s("transactions.amount")}),a.jsx("input",{type:"number",value:p||"",onChange:e=>m(Number(e.target.value)),placeholder:"0.00",min:"0",step:"0.01",style:{padding:"var(--space-sm) var(--space-md)",borderRadius:"var(--radius-md)",border:"1px solid var(--color-border)",background:"var(--color-bg)",color:"var(--color-text)",fontSize:"var(--font-size-lg)"}})]}),a.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"4px"},children:[a.jsx("label",{style:{fontSize:"var(--font-size-sm)",color:"var(--color-text-muted)"},children:s("transactions.category")}),a.jsx("select",{value:N,onChange:e=>u(e.target.value),style:{padding:"var(--space-sm) var(--space-md)",borderRadius:"var(--radius-md)",border:"1px solid var(--color-border)",background:"var(--color-bg)",color:"var(--color-text)"},children:_.map(e=>a.jsxs("option",{value:e,children:[f[e]," ",s(`categories.${e}`)]},e))})]}),a.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"4px"},children:[a.jsx("label",{style:{fontSize:"var(--font-size-sm)",color:"var(--color-text-muted)"},children:s("transactions.description")}),a.jsx("input",{type:"text",value:v,onChange:e=>g(e.target.value),placeholder:s("transactions.description"),style:{padding:"var(--space-sm) var(--space-md)",borderRadius:"var(--radius-md)",border:"1px solid var(--color-border)",background:"var(--color-bg)",color:"var(--color-text)"}})]}),a.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"4px"},children:[a.jsx("label",{style:{fontSize:"var(--font-size-sm)",color:"var(--color-text-muted)"},children:s("transactions.date")}),a.jsx("input",{type:"date",value:C,onChange:e=>x(e.target.value),style:{padding:"var(--space-sm) var(--space-md)",borderRadius:"var(--radius-md)",border:"1px solid var(--color-border)",background:"var(--color-bg)",color:"var(--color-text)"}})]}),a.jsxs("div",{style:{display:"flex",gap:"var(--space-sm)"},children:[a.jsx("button",{className:r["btn-primary"],onClick:E,style:{flex:1},children:s("common.save")}),n?.id&&a.jsx("button",{onClick:()=>{z(n.id),h()},style:{padding:"var(--space-sm) var(--space-lg)",borderRadius:"var(--radius-md)",background:"rgba(239,68,68,0.1)",color:"var(--color-danger)",fontWeight:600},children:s("common.delete")})]})]}),j.length===0&&!i?a.jsxs("div",{className:r["empty-state"],children:[a.jsx("span",{className:r["empty-icon"],children:"ðŸ’³"}),a.jsx("p",{className:r["empty-text"],children:s("transactions.noTransactions")})]}):a.jsx("div",{className:r["card-list"],children:j.map(e=>{const o=Y(e.category);return a.jsxs("div",{className:r.card,onClick:()=>T(e),style:{cursor:"pointer",borderLeft:`4px solid ${o.border}`},children:[a.jsxs("div",{className:r["card-left"],children:[a.jsx("div",{className:r["card-icon"],style:{background:o.bg,color:o.text},children:f[e.category]||"ðŸ“Œ"}),a.jsxs("div",{className:r["card-info"],children:[a.jsx("span",{className:r["card-title"],children:e.description}),a.jsxs("span",{className:r["card-subtitle"],children:[s(`categories.${e.category}`)," Â· ",W(e.date)]})]})]}),a.jsx("div",{className:r["card-right"],children:a.jsxs("span",{className:`${r["card-amount"]} ${r[e.type]}`,children:[e.type==="income"?"+":"-",L(e.amount,b)]})})]},e.id)})})]})}export{P as default};
